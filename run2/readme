Here's the second run, mostly related to Zara's project. 

Same 96 Niono coluzzii and most of other stuff, but with 2 changes: 
1) I relax the assumption of having >=20 polymorphic sites. There is a speculation on the potential bias on the estimated rho if we cherry-pick the windows with the highest polymorphism. 
We cannot detect any recombination if there is zero or one polymorphic sites. The minimum is two. Therefore we use >=2 as the criteria. 

2) The second improvement is the exhaustive evaluation of all 100bp windows. No more random sampling of windows - I go through them one by one. It's slow. 
